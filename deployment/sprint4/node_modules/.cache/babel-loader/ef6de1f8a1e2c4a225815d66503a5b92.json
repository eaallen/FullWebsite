{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Elijah Allen\\\\Desktop\\\\WEBDEV\\\\IS_413\\\\sprint4\\\\src\\\\comps\\\\context\\\\AppProvider.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport App from '../../App';\nimport AppContext from './AppContext';\nimport Spinner from 'react-bootstrap/Spinner';\nimport produce from 'immer';\nimport ProductDetail from '../ProductDetail'; //import immer\n\nclass AppProvider extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.addToCart = pid => {\n      this.setState(state => produce(state, draft => {\n        if (!draft.cart[pid]) {\n          draft.cart[pid] = 1;\n        } else {\n          draft.cart[pid]++;\n        }\n      }));\n    };\n\n    this.addToRecentViews = product => {\n      console.log('state.addToRecentViews()', this.state.recentViews);\n      this.setState(state => produce(state, draft => {\n        console.log('draft.recentViews.unshift(product)', draft.recentViews.find(x => x.id === product.id));\n\n        if (draft.recentViews.indexOf(product.id) === -1) {\n          draft.recentViews.unshift(product);\n        } else {\n          draft.recentViews.splice(draft.recentViews.indexOf(product.id), 1);\n          draft.recentViews.unshift(product);\n        }\n      }));\n    };\n\n    this.removeFromCart = prodID => {\n      console.log('inthe removoreFromCart---------->------>');\n      this.setState(state => produce(state, draft => {\n        delete draft.cart[prodID];\n      }));\n    };\n\n    this.getCartCount = () => {\n      console.log('in the getCartCount');\n      let arr_cart = Object.entries(this.state.cart);\n      let count = null;\n\n      for (const item of arr_cart) {\n        if (!count) count = 0;\n        count += item;\n      }\n\n      return count;\n    };\n\n    this.getCartTotalPrice = () => {\n      let arr_cart = Object.entries(this.state.cart);\n      let total_price = 0;\n\n      for (const item of arr_cart) {\n        let item_info = this.state.product.find(x => x.id === parseInt(item[0]));\n        let price = parseFloat(item_info.price) * item[1];\n        total_price += price;\n      }\n\n      return total_price;\n    };\n\n    this.emptyCart = prodID => {\n      console.log('inthe removoreFromCart---------->------>');\n      this.setState(state => produce(state, draft => {\n        draft.cart = {};\n      }));\n    };\n\n    this.actions = {\n      addToCart: this.addToCart,\n      removeFromCart: this.removeFromCart,\n      getCartCount: this.getCartCount,\n      getCartTotalPrice: this.getCartTotalPrice,\n      emptyCart: this.emptyCart,\n      addToRecentViews: this.addToRecentViews\n    };\n    this.state = {\n      categories: null,\n      product: null,\n      cart: {},\n      recentViews: []\n    }; //.....where pid is the id of the product.....\n  }\n\n  render() {\n    if (!this.state.product) {\n      return React.createElement(React.Fragment, null, React.createElement(Spinner, {\n        animation: \"border\",\n        variant: \"danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }\n      }));\n    }\n\n    return React.createElement(React.Fragment, null, React.createElement(AppContext.Provider, {\n      value: { ...this.state,\n        ...this.actions\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, React.createElement(App, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    })));\n  }\n\n  async componentDidMount() {\n    const cate = await axios.get('http://localhost:8000/category/');\n    const prod = await axios.get('http://localhost:8000/product/');\n    this.setState({ ...this.state,\n      categories: cate.data,\n      product: prod.data\n    });\n  }\n\n}\n\nexport default AppProvider;","map":{"version":3,"sources":["C:/Users/Elijah Allen/Desktop/WEBDEV/IS_413/sprint4/src/comps/context/AppProvider.js"],"names":["React","axios","App","AppContext","Spinner","produce","ProductDetail","AppProvider","Component","constructor","props","addToCart","pid","setState","state","draft","cart","addToRecentViews","product","console","log","recentViews","find","x","id","indexOf","unshift","splice","removeFromCart","prodID","getCartCount","arr_cart","Object","entries","count","item","getCartTotalPrice","total_price","item_info","parseInt","price","parseFloat","emptyCart","actions","categories","render","componentDidMount","cate","get","prod","data"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport axios from 'axios';\r\nimport App from '../../App'\r\nimport AppContext from './AppContext'\r\nimport Spinner from 'react-bootstrap/Spinner'\r\nimport produce from 'immer'\r\nimport ProductDetail from '../ProductDetail';\r\n//import immer\r\nclass AppProvider extends React.Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.actions={\r\n            addToCart: this.addToCart,\r\n            removeFromCart: this.removeFromCart,\r\n            getCartCount: this.getCartCount, \r\n            getCartTotalPrice: this.getCartTotalPrice, \r\n            emptyCart: this.emptyCart,  \r\n            addToRecentViews: this.addToRecentViews,\r\n        }\r\n        this.state = {\r\n            categories: null,\r\n            product: null,\r\n            cart: {\r\n                \r\n            },\r\n            recentViews:[], \r\n            \r\n        }\r\n        //.....where pid is the id of the product.....\r\n    }\r\n    addToCart = (pid) =>{\r\n        this.setState(state=> produce(state, draft=>{\r\n            if(!draft.cart[pid]){\r\n                draft.cart[pid] = 1\r\n            }else{\r\n                draft.cart[pid]++\r\n            }\r\n        }))\r\n        \r\n    }\r\n    addToRecentViews = (product) =>{\r\n        console.log('state.addToRecentViews()', this.state.recentViews)\r\n        this.setState(state=> produce(state, draft=>{\r\n            console.log('draft.recentViews.unshift(product)',draft.recentViews.find(x=> x.id===product.id))\r\n            if(draft.recentViews.indexOf(product.id)===-1){\r\n                draft.recentViews.unshift(product)\r\n            }else{\r\n                draft.recentViews.splice(draft.recentViews.indexOf(product.id),1)\r\n                draft.recentViews.unshift(product)\r\n            }\r\n        }))\r\n\r\n    }\r\n    removeFromCart = (prodID) =>{\r\n        console.log('inthe removoreFromCart---------->------>')\r\n        this.setState(state=>produce(state,draft =>{\r\n            delete draft.cart[prodID]\r\n        }))\r\n    }\r\n    getCartCount = () =>{\r\n        console.log('in the getCartCount')\r\n        let arr_cart = Object.entries(this.state.cart)\r\n        let count = null\r\n        for(const item of arr_cart){\r\n            if(!count)count=0\r\n            count += item    \r\n        }\r\n        return count\r\n    }\r\n    getCartTotalPrice = () =>{\r\n        let arr_cart = Object.entries(this.state.cart)\r\n        let total_price = 0\r\n        for(const item of arr_cart){\r\n            let item_info = this.state.product.find(x=> x.id===parseInt(item[0]))\r\n            let price = parseFloat(item_info.price) * item[1]\r\n            total_price += price\r\n        }\r\n        return total_price\r\n    }    \r\n    emptyCart = (prodID) =>{\r\n        console.log('inthe removoreFromCart---------->------>')\r\n        this.setState(state=>produce(state,draft =>{\r\n            draft.cart={}\r\n        }))\r\n    }\r\n    render(){\r\n        if(!this.state.product){\r\n            return(\r\n                <>\r\n                    <Spinner animation=\"border\" variant=\"danger\" />                    \r\n                </>\r\n            ) \r\n    \r\n        }      \r\n        return(\r\n            <>\r\n                <AppContext.Provider  value={{...this.state, ...this.actions}}>\r\n                    <App/>\r\n                </AppContext.Provider>\r\n                \r\n            </> \r\n        )\r\n        \r\n    }\r\n    async componentDidMount(){\r\n        const cate =  await axios.get('http://localhost:8000/category/')\r\n        const prod =  await axios.get('http://localhost:8000/product/')\r\n        this.setState({...this.state, categories: cate.data, product: prod.data})\r\n    }\r\n}\r\nexport default AppProvider"]},"metadata":{},"sourceType":"module"}